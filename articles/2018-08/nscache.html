<!DOCTYPE html>
<html>

  <head>
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-5VLL8HQ');</script>
  <!-- End Google Tag Manager -->
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-5VL9R6T5ZN"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-5VL9R6T5ZN');
  </script>

  <!-- encoding -->
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, viewport-fit=cover">

  <!-- Primary Meta Tags -->
  <title>NSCache - hcn1519 DEV</title>
  <meta name="author" content="Changnam Hong">
  <meta name="title" content="NSCache - hcn1519 DEV">
  <meta name="description" content="NSCacheì— ëŒ€í•´ ì•Œì•„ë´…ë‹ˆë‹¤.">
  <meta name="theme-color" content="#f1f3f4" media="(prefers-color-scheme: light)">
  <meta name="theme-color" content="#000000" media="(prefers-color-scheme: dark)">
  
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="NSCache">
  <meta property="og:image" content="/public/assets/blogThumb-noRadius.png">
  <meta property="og:description" content="NSCacheì— ëŒ€í•´ ì•Œì•„ë´…ë‹ˆë‹¤.">

  <!-- CSS -->
  <link rel="stylesheet" href="/public/sass/blogTheme.scss.css" async>
  <link rel="stylesheet" href="/public/sass/menu.scss.css" async>
  <link rel="stylesheet" href="/public/sass/syntax.scss.css" async>
  <!-- Icons -->
  <link rel="icon" type="image/png" href="/icons/android-chrome-512x512.png" sizes="512x512">
  <link rel="shortcut icon" href="/icons/favicon.ico">
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon_32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon_16x16.png">
  <link rel="icon" type="image/png" href="/icons/android_chrome_192x192.png" sizes="192x192">
  <link rel="manifest" href="/icons/site.webmanifest">
  
  <!-- Fonts -->
  <link rel="preload" href="/public/fonts/Age-Normal.woff2" as="font" type="font/woff2" crossorigin>
  <link rel="preload" href="/public/fonts/Mona-Sans-Regular.woff2" as="font" type="font/woff2" crossorigin>
  <link rel="preload" href="/public/fonts/Mona-Sans-SemiBold.woff2" as="font" type="font/woff2" crossorigin>
  <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="hcn1519 DEV" />

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml" async>

</head>


  <body>
      <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5VLL8HQ"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="" title="Home">HCN</a>
            <span>DEV</span>
          
          </h3>
        </div>
      </div>
      
      <nav class="menu">
  <div class="menu-container">
    <ul class="menu-list">
      <li class="menu-item">
        <a class="menu-link" href="/">Home</a>
      </li>

      
      
        
          
        
      
        
          
        
      
        
          
            <li class="menu-item">
              <a class="menu-link" href="/about">About</a>
            </li>
          
        
      
        
          
            <li class="menu-item">
              <a class="menu-link" href="/archives/">Archives</a>
            </li>
          
        
      
        
      
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
      
        
      
        
          
            <li class="menu-item">
              <a class="menu-link" href="/tags/">Tags</a>
            </li>
          
        
      
    </ul>
  </div>

  <a class="menu-toggle">
    <div class="menu-hamburger"></div>
  </a>
</nav>


      <div class="column-wrapper">  
        <aside class="side-menu-in-desktop">
          <ul class="menu-list">
  <li class="menu-item">
    <a class="menu-link" href="/">Home</a>
  </li>

  
  
    
      
    
  
    
      
    
  
    
      
        <li class="menu-item">
          <a class="menu-link" href="/about">About</a>
        </li>
      
    
  
    
      
        <li class="menu-item">
          <a class="menu-link" href="/archives/">Archives</a>
        </li>
      
    
  
    
  
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
  
    
  
    
      
        <li class="menu-item">
          <a class="menu-link" href="/tags/">Tags</a>
        </li>
      
    
  
</ul>
        </aside>
        <div class="container content">
          <div class="post">
  <h2 class="post-title">NSCache</h2>
  <span class="post-date">28 Aug 2018</span>
  

  

  

  
  

        
  
  
  <ul>
  <li><code class="language-plaintext highlighter-rouge">NSCache</code>ëŠ” Cocoaì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ìºì‹±ì„ ìœ„í•œ í´ë˜ìŠ¤ì…ë‹ˆë‹¤. <code class="language-plaintext highlighter-rouge">NSCache</code>ëŠ” <code class="language-plaintext highlighter-rouge">NSDictionary</code>ì²˜ëŸ¼ <code class="language-plaintext highlighter-rouge">key-value</code> í˜•íƒœë¡œ ë˜ì–´ ìˆìŠµë‹ˆë‹¤.</li>
  <li><code class="language-plaintext highlighter-rouge">NSCache</code>ëŠ” ë©”ëª¨ë¦¬ê°€ ì¶©ë¶„í•  ë•ŒëŠ” ì£¼ì–´ì§„ ëª¨ë“  ë°ì´í„°ë¥¼ ìºì‹±í•©ë‹ˆë‹¤. ë°˜ë©´, ê°€ìš© ë©”ëª¨ë¦¬ê°€ ì ì„ ë•ŒëŠ” ë‹¤ë¥¸ ì•±ì„ ìœ„í•´ ìºì‹±ëœ ë°ì´í„°ë¥¼ ìë™ìœ¼ë¡œ ë²„ë¦½ë‹ˆë‹¤.</li>
</ul>

<blockquote>
  <p>ì´ë ‡ê²Œ ë²„ë ¤ì§„ ë°ì´í„°ëŠ” í•„ìš”í•  ë•Œ ë‹¤ì‹œ ìºì‹±í•´ì•¼ í•©ë‹ˆë‹¤. ë°”ê¿”ë§í•˜ë©´, ìºì‹±ëœ ë°ì´í„°ê°€ ì—†ì–´ë„ ì•±ì´ ì ì ˆíˆ ë™ì‘(i.e. ë‹¤ì‹œ ë°ì´í„° ìºì‹±)í•  ìˆ˜ ìˆë„ë¡ êµ¬ì¡°ë¥¼ ì„¤ê³„í•´ì•¼ í•©ë‹ˆë‹¤.</p>
</blockquote>

<h2 id="nscache-property">NSCache Property</h2>

<ul>
  <li>countLimit - <code class="language-plaintext highlighter-rouge">NSCache</code>ëŠ” ìºì‹±í•˜ëŠ” ë°ì´í„°ì˜ ê°œìˆ˜ë¥¼ ì œí•œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë§Œì•½ countLimitì´ 10ìœ¼ë¡œ ì„¤ì •ë˜ì–´ ìˆëŠ”ë°, 11ê°œì˜ ë°ì´í„°ë¥¼ <code class="language-plaintext highlighter-rouge">NSCache</code>ì— ë„£ê²Œ ë˜ë©´ 1ê°œëŠ” ìë™ìœ¼ë¡œ ë²„ë¦½ë‹ˆë‹¤.</li>
  <li>totalCostLimit - <code class="language-plaintext highlighter-rouge">NSCache</code>ëŠ” ê°ì²´ë¥¼ ì¶”ê°€í•  ë•Œ cost(<code class="language-plaintext highlighter-rouge">Int</code>)ë¥¼ í•¨ê»˜ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ë•Œ, <code class="language-plaintext highlighter-rouge">totalCostLimit</code>ì€ costë“¤ì˜ ì´í•©ì˜ ìµœëŒ“ê°’ì…ë‹ˆë‹¤. ì¦‰, <code class="language-plaintext highlighter-rouge">NSCache</code>ì— ì¶”ê°€ëœ ë°ì´í„°ë“¤ì˜ costê°€ <code class="language-plaintext highlighter-rouge">totalCostLimit</code>ì— ë„ë‹¬í•˜ê±°ë‚˜ ë„˜ê²Œ ë˜ë©´ <code class="language-plaintext highlighter-rouge">NSCache</code>ëŠ” ë°ì´í„°ë¥¼ ë²„ë¦½ë‹ˆë‹¤.</li>
</ul>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">let</span> <span class="nv">cache</span><span class="p">:</span> <span class="kt">NSCache</span><span class="o">&lt;</span><span class="kt">NSString</span><span class="p">,</span> <span class="kt">UIImage</span><span class="o">&gt;</span> <span class="o">=</span> <span class="kt">NSCache</span><span class="p">()</span>
<span class="n">cache</span><span class="o">.</span><span class="n">countLimit</span> <span class="o">=</span> <span class="n">í—ˆìš©í•˜ëŠ”</span> <span class="n">keyì˜</span> <span class="n">ê°œìˆ˜</span>
<span class="n">cache</span><span class="o">.</span><span class="n">totalCostLimit</span> <span class="o">=</span> <span class="n">cost</span> <span class="n">í•©ê³„ì˜</span> <span class="n">ìµœëŒ“ê°’</span>
</code></pre></div></div>

<ul>
  <li>evictsObjectsWithDiscardedContent - <code class="language-plaintext highlighter-rouge">NSCache</code>ëŠ” ì‹œìŠ¤í…œì—ì„œ ë©”ëª¨ë¦¬ë¥¼ ë„ˆë¬´ ë§ì´ ì‚¬ìš©í•˜ì§€ ì•Šë„ë¡ ë””ìì¸ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ ìºì‹±ëœ ë°ì´í„°ë¥¼ ìë™ìœ¼ë¡œ ì§€ìš°ëŠ” ë‹¤ì–‘í•œ ì •ì±…ì„ ì‚¬ìš©í•˜ê³  ìˆê³ , ìºì‹±ëœ ë°ì´í„°ê°€ ë„ˆë¬´ ë§ì€ ë©”ëª¨ë¦¬ë¥¼ ì‚¬ìš©í•˜ë©´ ì‹œìŠ¤í…œì€ ìºì‹±ëœ ë°ì´í„°ë¥¼ ì‚­ì œí•©ë‹ˆë‹¤.</li>
</ul>

<blockquote>
  <p>The NSCache class incorporates various auto-eviction policies, which ensure that a cache doesnâ€™t use too much of the systemâ€™s memory. If memory is needed by other applications, these policies remove some items from the cache, minimizing its memory footprint.</p>
</blockquote>

<blockquote>
  <p>ì´ ë¶€ë¶„ì€ ì¢€ ë” ì•Œì•„ë³´ê³  êµ¬ì²´ì ì¸ ì„œìˆ ì„ í•˜ê³ ì í•©ë‹ˆë‹¤.</p>
</blockquote>

<h2 id="nscache-êµ¬í˜„">NSCache êµ¬í˜„</h2>

<p>NSCacheê°€ ì–´ë–»ê²Œ êµ¬í˜„ë˜ì–´ ìˆëŠ”ì§€ëŠ” ì• í”Œì—ì„œ ê³µê°œí•œ <a href="https://github.com/apple/swift-corelibs-foundation/blob/master/Foundation/NSCache.swift">Foundation - NSCache</a>ë¥¼ ì‚´í´ë³´ë©´ íŒŒì•…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<p><code class="language-plaintext highlighter-rouge">NSCache</code>ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ì—°ê²°ë¦¬ìŠ¤íŠ¸ë¡œ ë°ì´í„°ë¥¼ ìºì‹±í•©ë‹ˆë‹¤. ì—°ê²°ë¦¬ìŠ¤íŠ¸ë¡œ ë°ì´í„°ë¥¼ ìºì‹±í•˜ëŠ” ì´ìœ ì— ëŒ€í•´ì„œ ëª…í™•íˆ ì„œìˆ ë˜ì–´ ìˆì§€ëŠ” ì•Šì§€ë§Œ, ìºì‹œëŠ” ì¤‘ê°„ì— ìˆëŠ” ë°ì´í„° ì¶”ê°€, ì‚­ì œê°€ ë¹ˆë²ˆí•˜ê¸° ë•Œë¬¸ì— ì´ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ í•˜ê¸° ìœ„í•´(ë°°ì—´ë¡œ í•´ë‹¹ ì‘ì—…ì„ ìˆ˜í–‰ì‹œ ë°ì´í„°ë¥¼ ì•ìœ¼ë¡œ ë‹¹ê¸°ê±°ë‚˜, ë’¤ë¡œ ë°ì´í„°ë¥¼ ëª¨ë‘ ë°€ì–´ì•¼ í•˜ëŠ” ì‘ì—…ì´ ì¶”ê°€ì ìœ¼ë¡œ ë°œìƒí•©ë‹ˆë‹¤.) ì—°ê²°ë¦¬ìŠ¤íŠ¸ë¡œ êµ¬í˜„ëœ ê²ƒì´ë¼ê³  ìƒê°í•´ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<p>í•œí¸, <code class="language-plaintext highlighter-rouge">NSCache</code>ëŠ” ë³„ë„ë¡œ Dictionaryë¥¼ ë‘ì–´ ë°ì´í„°ì˜ ì ‘ê·¼ë„ O(1)ì— ìˆ˜í–‰í•  ìˆ˜ ìˆë„ë¡ ì œê³µí•˜ê³  ìˆìŠµë‹ˆë‹¤.</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="c1">// NSCache</span>
<span class="kd">open</span> <span class="kd">class</span> <span class="kt">NSCache</span><span class="o">&lt;</span><span class="kt">KeyType</span> <span class="p">:</span> <span class="kt">AnyObject</span><span class="p">,</span> <span class="kt">ObjectType</span> <span class="p">:</span> <span class="kt">AnyObject</span><span class="o">&gt;</span> <span class="p">:</span> <span class="kt">NSObject</span> <span class="p">{</span>

    <span class="kd">private</span> <span class="k">var</span> <span class="nv">_entries</span> <span class="o">=</span> <span class="kt">Dictionary</span><span class="o">&lt;</span><span class="kt">NSCacheKey</span><span class="p">,</span> <span class="kt">NSCacheEntry</span><span class="o">&lt;</span><span class="kt">KeyType</span><span class="p">,</span> <span class="kt">ObjectType</span><span class="o">&gt;&gt;</span><span class="p">()</span>
    <span class="kd">private</span> <span class="k">var</span> <span class="nv">_head</span><span class="p">:</span> <span class="kt">NSCacheEntry</span><span class="o">&lt;</span><span class="kt">KeyType</span><span class="p">,</span> <span class="kt">ObjectType</span><span class="o">&gt;</span><span class="p">?</span>
<span class="p">}</span></code></pre></figure>

<h2 id="nscache-ë°ì´í„°-êµì²´-ì•Œê³ ë¦¬ì¦˜">NSCache ë°ì´í„° êµì²´ ì•Œê³ ë¦¬ì¦˜</h2>

<p>ì¼ë°˜ì ìœ¼ë¡œ ìºì‹œëŠ” ìºì‹±ëœ ë°ì´í„°ë¥¼ ë²„ë¦¬ëŠ” ë°©ì‹ì— ìˆì–´ì„œ ìš©ë„ì— ë”°ë¼ ì„œë¡œ ë‹¤ë¥¸ í˜ì´ì§€ êµì²´ ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. í”íˆ, FIFO, LRU, LFU ë“±ì˜ ë©”ëª¨ë¦¬ í˜ì´ì§€ êµì²´ ì•Œê³ ë¦¬ì¦˜ë“¤ì´ ì‚¬ìš©ë˜ëŠ”ë°, <code class="language-plaintext highlighter-rouge">NSCache</code>ëŠ” ì´ì™€ëŠ” ì¡°ê¸ˆ ë‹¤ë¥¸ ë°©ì‹ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì·¨í•˜ê³  ë²„ë¦½ë‹ˆë‹¤.</p>

<p><code class="language-plaintext highlighter-rouge">NSCache</code>ì—ëŠ” ê°œë³„ ë°ì´í„°ë§ˆë‹¤ cost ê°’ì„ ë¶€ì—¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. <code class="language-plaintext highlighter-rouge">NSCache</code>ëŠ” ì´ costê°’ì˜ ì˜¤ë¦„ì°¨ìˆœìœ¼ë¡œ ë°ì´í„°ë¥¼ ì¶”ê°€í•  ë•Œ ì •ë ¬ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤. ì‹¤ì œ ì½”ë“œë¥¼ ì‚´í´ë³´ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="kd">private</span> <span class="kd">func</span> <span class="nf">insert</span><span class="p">(</span><span class="n">_</span> <span class="nv">entry</span><span class="p">:</span> <span class="kt">NSCacheEntry</span><span class="o">&lt;</span><span class="kt">KeyType</span><span class="p">,</span> <span class="kt">ObjectType</span><span class="o">&gt;</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">guard</span> <span class="k">var</span> <span class="nv">currentElement</span> <span class="o">=</span> <span class="n">_head</span> <span class="k">else</span> <span class="p">{</span>
        <span class="c1">// The cache is empty</span>
        <span class="n">entry</span><span class="o">.</span><span class="n">prevByCost</span> <span class="o">=</span> <span class="kc">nil</span>
        <span class="n">entry</span><span class="o">.</span><span class="n">nextByCost</span> <span class="o">=</span> <span class="kc">nil</span>

        <span class="n">_head</span> <span class="o">=</span> <span class="n">entry</span>
        <span class="k">return</span>
    <span class="p">}</span>

    <span class="k">guard</span> <span class="n">entry</span><span class="o">.</span><span class="n">cost</span> <span class="o">&gt;</span> <span class="n">currentElement</span><span class="o">.</span><span class="n">cost</span> <span class="k">else</span> <span class="p">{</span>
        <span class="c1">// Insert entry at the head</span>
        <span class="n">entry</span><span class="o">.</span><span class="n">prevByCost</span> <span class="o">=</span> <span class="kc">nil</span>
        <span class="n">entry</span><span class="o">.</span><span class="n">nextByCost</span> <span class="o">=</span> <span class="n">currentElement</span>
        <span class="n">currentElement</span><span class="o">.</span><span class="n">prevByCost</span> <span class="o">=</span> <span class="n">entry</span>

        <span class="n">_head</span> <span class="o">=</span> <span class="n">entry</span>
        <span class="k">return</span>
    <span class="p">}</span>

    <span class="k">while</span> <span class="k">let</span> <span class="nv">nextByCost</span> <span class="o">=</span> <span class="n">currentElement</span><span class="o">.</span><span class="n">nextByCost</span><span class="p">,</span> <span class="n">nextByCost</span><span class="o">.</span><span class="n">cost</span> <span class="o">&lt;</span> <span class="n">entry</span><span class="o">.</span><span class="n">cost</span> <span class="p">{</span>
        <span class="n">currentElement</span> <span class="o">=</span> <span class="n">nextByCost</span>
    <span class="p">}</span>

    <span class="c1">// Insert entry between currentElement and nextElement</span>
    <span class="k">let</span> <span class="nv">nextElement</span> <span class="o">=</span> <span class="n">currentElement</span><span class="o">.</span><span class="n">nextByCost</span>

    <span class="n">currentElement</span><span class="o">.</span><span class="n">nextByCost</span> <span class="o">=</span> <span class="n">entry</span>
    <span class="n">entry</span><span class="o">.</span><span class="n">prevByCost</span> <span class="o">=</span> <span class="n">currentElement</span>

    <span class="n">entry</span><span class="o">.</span><span class="n">nextByCost</span> <span class="o">=</span> <span class="n">nextElement</span>
    <span class="n">nextElement</span><span class="p">?</span><span class="o">.</span><span class="n">prevByCost</span> <span class="o">=</span> <span class="n">entry</span>
<span class="p">}</span></code></pre></figure>

<p>ìœ„ì˜ ì½”ë“œë¥¼ ë³´ë©´ <code class="language-plaintext highlighter-rouge">NSCache</code>ì— ë°ì´í„°ë¥¼ ì¶”ê°€í•  ë•Œ, costê°’ì„ ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬ì„ ìˆ˜í–‰í•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë˜í•œ ì‚­ì œì˜ ê²½ìš°, ìƒˆë¡œìš´ ê°’ì„ ì¶”ê°€í•  ë•Œ, ê°’ì´ ì‘ì€ ë°ì´í„°ë“¤ì„ ìˆœì°¨ì ìœ¼ë¡œ ì œê±°í•˜ì—¬ totalCostLimitì„ ìœ ì§€í•˜ëŠ” ë°©ì‹ì„ í™œìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤.</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="c1">// open func setObject(_ obj: ObjectType, forKey key: KeyType, cost g: Int)ì˜ ì¼ë¶€ ë°œì·Œ</span>
<span class="c1">// CostLimitì— ê¸°ë°˜í•˜ì—¬ ë°ì´í„° ì œê±°(Purging)</span>
<span class="c1">// purgeAmount = ì¤„ì—¬ì•¼ í•˜ëŠ” costì˜ ì´ëŸ‰</span>
<span class="k">var</span> <span class="nv">purgeAmount</span> <span class="o">=</span> <span class="p">(</span><span class="n">totalCostLimit</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">?</span> <span class="p">(</span><span class="n">_totalCost</span> <span class="o">-</span> <span class="n">totalCostLimit</span><span class="p">)</span> <span class="p">:</span> <span class="mi">0</span>
<span class="k">while</span> <span class="n">purgeAmount</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">{</span>
    <span class="k">if</span> <span class="k">let</span> <span class="nv">entry</span> <span class="o">=</span> <span class="n">_head</span> <span class="p">{</span>
        <span class="n">delegate</span><span class="p">?</span><span class="o">.</span><span class="nf">cache</span><span class="p">(</span><span class="nf">unsafeDowncast</span><span class="p">(</span><span class="k">self</span><span class="p">,</span> <span class="nv">to</span><span class="p">:</span><span class="kt">NSCache</span><span class="o">&lt;</span><span class="kt">AnyObject</span><span class="p">,</span> <span class="kt">AnyObject</span><span class="o">&gt;.</span><span class="k">self</span><span class="p">),</span> <span class="nv">willEvictObject</span><span class="p">:</span> <span class="n">entry</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>

        <span class="c1">// ì‘ì€(headìª½) costì˜ ë°ì´í„°ë“¤ë¶€í„° ì œê±°í•´ë‚˜ê°</span>
        <span class="n">_totalCost</span> <span class="o">-=</span> <span class="n">entry</span><span class="o">.</span><span class="n">cost</span>
        <span class="n">purgeAmount</span> <span class="o">-=</span> <span class="n">entry</span><span class="o">.</span><span class="n">cost</span>

        <span class="nf">remove</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span> <span class="c1">// _head will be changed to next entry in remove(_:)</span>
        <span class="n">_entries</span><span class="p">[</span><span class="kt">NSCacheKey</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">key</span><span class="p">)]</span> <span class="o">=</span> <span class="kc">nil</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">break</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>ë°ì´í„° ì¶”ê°€ ì‚­ì œë¥¼ cost ì¤‘ì‹¬ìœ¼ë¡œ ì„¤ëª…í•˜ì˜€ëŠ”ë°, countë¥¼ í†µí•´ì„œë„ í•´ë‹¹ ì‘ì—…ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤. ì´ ë¶€ë¶„ì€ ì—¬ê¸°ì„œ ë”°ë¡œ ì„œìˆ í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.(costë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì¶”ê°€ ì‚­ì œí•˜ëŠ” ê²ƒê³¼ í¬ê²Œ ë‹¤ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.)</p>

<p>ì „ì²´ ì½”ë“œëŠ” <a href="https://github.com/apple/swift-corelibs-foundation/blob/master/Foundation/NSCache.swift">Foundation - NSCache</a>ì—ì„œ í™•ì¸í•˜ì‹¤ ìˆ˜ ìˆìœ¼ë‹ˆ, ì´ë¥¼ ì°¸ê³ í•˜ì‹œë©´ ì¢‹ì„ ê²ƒ ê°™ìŠµë‹ˆë‹¤.</p>

<hr />

<h1 id="ì°¸ê³ -ìë£Œ">ì°¸ê³  ìë£Œ</h1>

<ul>
  <li><a href="https://developer.apple.com/documentation/foundation/nscache">NSCache - Apple Documentation</a></li>
  <li><a href="https://developer.apple.com/library/archive/documentation/Performance/Conceptual/ManagingMemory/Articles/CachingandPurgeableMemory.html">Caching and Purgeable Memory</a></li>
  <li><a href="https://nshipster.com/nscache/">NSHipster - NSCache</a></li>
  <li><a href="https://github.com/apple/swift-corelibs-foundation/blob/master/Foundation/NSCache.swift">Foundation - NSCache</a></li>
</ul>


<div class="related">
  
  
  
  
  
  

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    
      
        
        <h2>ì½ì–´ ë³¼ë§Œí•œ ë‹¤ë¥¸ ê¸€</h2>
        
      <ul class="related-posts">
      
        <li>
          <h3>
            <a href="/articles/2018-09/wwdc2018session416">
              iOS Memory Footprint ë¶„ì„ ë°©ë²•
              <small>01 Sep 2018</small>
            </a>
            <small> 
            <div class="tag-chips">
              <a class="tag-link" href="/tags/#iOS">
                iOS
              </a>
            </div>
           
            <div class="tag-chips">
              <a class="tag-link" href="/tags/#Memory">
                Memory
              </a>
            </div>
          </small>
          </h3>
        </li>
      </li>
      
      
    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    
      
        <li>
          <h3>
            <a href="/articles/2018-07/swift_automatic_reference_counting">
              Swift ARC
              <small>25 Jul 2018</small>
            </a>
            <small> 
            <div class="tag-chips">
              <a class="tag-link" href="/tags/#Swift">
                Swift
              </a>
            </div>
           
            <div class="tag-chips">
              <a class="tag-link" href="/tags/#Memory">
                Memory
              </a>
            </div>
          </small>
          </h3>
        </li>
      </li>
      
      
    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  

    
    

    

    

  
  </ul>

  
</div>


<script>
  
  if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
    // dark mode
    
  }
</script>
<script src="https://utteranc.es/client.js"
        repo="hcn1519/hcn1519.github.io"
        issue-term="og:title"
        label="gets Comments ğŸ™Œ"
        theme=github-dark
        crossorigin="anonymous"
        async>
</script>
<div class="back-home">
    <a href="">< Home</a>
  </div>
</div>
        </div>
        
      </div>
    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="/public/js/sidebarHamburger.js"></script>
  </body>
</html>
