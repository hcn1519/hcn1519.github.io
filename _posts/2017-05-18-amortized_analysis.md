---
layout: post
comments: true
title:  "Amortized Analysis(분할상환 분석)"
excerpt: "Amortized Analysis에 대해 알아봅니다."
categories: Algorithm Coursera
date:   2017-05-18 00:30:00
tags: [Algorithm, Amortized_Cost, Coursera]
---

분할상환 분석은 자료구조를 수행하는 경우에 필요한 시간의 평균을 구하는 분석방법입니다.
<div class="message">
  어떤 자료구조가 n번 연산이 될 때, 최악의 경우 필요한 비용을 구하고, 그 필요한 시간의 평균을 구하는 것입니다.
</div>

CLRS에서 소개하는 분석 방식은 크게 총계분석, 결산방법, 잠재비용방법이 있습니다. 각각의 분석이 어떤 방식으로 이뤄지는지 하나씩 살펴보겠습니다.

## 1. 총계분석(Aggregate method)

<div class="message">
  총계분석에서는 모든 n에 대해, 최악의 경우 전체적으로 T(n)의 시간복잡도를 지닐 때, 분할상환 비용(Amortized Cost)이 T(n)/n이 되는 분석법입니다.
</div>

무슨 의미인지 Stack을 예로 설명하겠습니다. Stack에는 기본적으로 `push`, `pop`의 메소드가 있습니다. 이 때 각각의 연산의 비용을 1이라고 정했을 때 시간복잡도는 어떻게 될까요? 네, 둘 모두 `O(1)`입니다. 왜냐하면 `push`, `pop`은 둘 다 `top`을 기준으로 원소를 넣고 뺴는 위치가 정해져 있기 때문입니다. 이 때 n개 연산에 대한 `push`, `pop` 각각의 시퀀스 비용은 어떻게 될까요? 여기서 n개 연산의 시퀀스 비용이라는 것은 해당 연산을 n번 할 경우 발생하는 총 비용에 시간복잡도를 곱한 것을 의미합니다. 즉, `push`의 비용은 1이고 시간복잡도는 `O(1)`이므로 연산이 n번 일어났을 떄 `push` 연산의 시퀀스 비용은 `O(n)`입니다.(`pop`도 `O(n)`입니다.)

| | 비용   | 시간 복잡도 | n번 수행 시퀀스 비용 |
|:--------:|:-------:|:-------:|:-------:|
|  Push      |   1     | O(1) | O(n) |
|  Pop      |   1     | O(1) | O(n) |
{: rules="groups"}

총계분석에서는 n번 수행한 각각의 시퀀스 비용을 합산(T(n))하여 이를 n으로 나눈 값을 **분할상환비용(Amortized Cost)** 이라고 말합니다. 이 비용은 `O(n)/n`이므로 `O(1)`이 됩니다.


그럼 여기서 해당 스택에 `MultiPop`이라는 연산을 추가해보겠습니다. 그렇다면, 분할상환비용은 변할까요? 그럴수도 있고 아닐 수도 있습니다. 총계분석은 자료구조 내의 모든 연산의 시퀀스 비용을 합산합니다. 그렇기 때문에 연산을 추가한다는 것은 평균을 내기 위한 값을 하나 더 추가한다는 것을 의미합니다. 그렇기 떄문에 위의 경우에서 `MultiPop`을 추가한다는 것은 다시 말해서 `MultiPop`의 n번 수행한 시퀀스 비용을 합산값에 추가해야 합니다. 그래서 이 때 그 값이 `O(n)`이라면 분할상환비용은 여전히 `O(1)`일 것이고, 그렇지 않다면 값이 변해야 합니다.

그렇다면 문제가 되는 것은 `MultiPop`의 n번 수행한 시퀀스 비용입니다. 이를 코드 기반으로 생각해서 `MultiPop`은 `Pop`이 n번 수행되는 것이기 때문에 비용이 `n`, 시간 복잡도가 `O(n)`이므로, n번 수행한 시퀀스 비용이 `O(n^2)`이라고 분석할 수도 있습니다. 이는 맞는 분석입니다만 이 비용을 모든 경우에 만족하면서 더 낮게 설정할 수 있습니다. 그리고 핵심 아이디어는 **Pop은 Push된 횟수만큼만 일어난다** 입니다. 즉, `Push`가 n번 일어나면 `MultiPop`은 n번 이상으로 일어날 수 없다는 것입니다. 그 결과 `MultiPop`의 n번 수행한 시퀀스 비용은 `O(n)`이 됩니다.

| | n번 수행 시퀀스 비용 |
|:--------:|:-------:|
|  Push | O(n) |
|  Pop  | O(n) |
|  MultiPop  | O(n) |
{: rules="groups"}

그렇기 때문에 `MultiPop` 연산을 추가해도 해당 스택의 분할상환비용은 `O(3n)/n`으로 `O(1)`이 됩니다.



-----

[Amortized Analysis - Youtube](https://www.youtube.com/watch?v=U5XKyIVy2Vc)
